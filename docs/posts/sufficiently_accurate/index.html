<!DOCTYPE html>
<html lang="en-us">
  <head><link rel="icon" href="../../chickensouple.github.io/chickensouple.github.io/favicon_main.svg"><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="x-ua-compatible" content="ie=edge" /><meta property="og:url"  content="chickensouple.github.io/posts/sufficiently_accurate/" />
    <meta property="og:type" content="article" /><meta property="og:title" content="Sufficiently Accurate Model Learning" /><meta property="og:description" content="" /><meta property="og:image:width"  content="600" />
        <meta property="og:image:height" content="477" /><meta property="og:image" content="/chickensouple.github.io/posts/sufficiently_accurate/images/main_huf56d47a1ef50456175de88d0aa5fd9f3_72932_600x0_resize_box_2.png" /><title>Clark Zhang - Sufficiently Accurate Model Learning</title>

    
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet"><link rel="stylesheet" type="text/css" href="../../chickensouple.github.io/chickensouple.github.io/css/style.143de6bfc6cfe35f12dec288425de51e8f1e02c5adff32a6d1cf48709141500b.css" integrity="sha256-FD3mv8bP418S3sKIQl3lHo8eAsWt/zKm0c9IcJFBUAs=">
<link rel="stylesheet" type="text/css" href="../../chickensouple.github.io/chickensouple.github.io/css/monokai-sublime.9.15.8.min.91376415864fdd3a92be524052267afece4bdb1bb8c6c754f5e60c5ac28e93be.css" integrity="sha256-kTdkFYZP3TqSvlJAUiZ6/s5L2xu4xsdU9eYMWsKOk74=">
<link rel="stylesheet" type="text/css" href="../../chickensouple.github.io/chickensouple.github.io/css/icons.f72c0103ff9598115ab2a76351494b950570479ce3f1795fec13fc62e4185dcf.css" integrity="sha256-9ywBA/&#43;VmBFasqdjUUlLlQVwR5zj8Xlf7BP8YuQYXc8=">
<link rel="stylesheet" type="text/css" href="../../chickensouple.github.io/chickensouple.github.io/css/refresh.ccfd23f8053a1571a3e474a6877f42a6a1924c6bbf1b64c7704b49a0353b4650.css" integrity="sha256-zP0j&#43;AU6FXGj5HSmh39CpqGSTGu/G2THcEtJoDU7RlA=">
<link rel="stylesheet" type="text/css" href="../../chickensouple.github.io/chickensouple.github.io/css/devicon.min.149016fbf45c8bc157d6f55ce3ee875feaa3f90446bf7d151fbc16a9f21a8859.css" integrity="sha256-FJAW&#43;/Rci8FX1vVc4&#43;6HX&#43;qj&#43;QRGv30VH7wWqfIaiFk=">
    

  </head>
  <body>
     

    <div id="preloader">
      <div id="status"></div>
    </div><nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">

      
      
      
      <a class="navbar-item">
        <div class="menu-icon-wrapper left-menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
        <div class="navbar-item left-menu-icon-wrapper">
          Menu
        </div>
      </a>

      
    </div></div>
</nav>
<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
      <div class="navbar-brand">
  
        
        
        
        <a class="navbar-item">
          <div class="menu-icon-wrapper left-menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
          <div class="navbar-item left-menu-icon-wrapper">
            Tags
          </div>
        </a>
  
        <div class="navbar-item is-expanded"></div>
        <a class="navbar-item is-hidden-desktop">  
          <div data-target="cloned-navbar-menu" class="navbar-item right-menu-icon-wrapper is-hidden-desktop">
            Menu
          </div>
          <div data-target="cloned-navbar-menu" class="menu-icon-wrapper right-menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
        </a>
      </div><div id="cloned-navbar-menu" class="navbar-menu is-static">
        <div class="navbar-end"><a href="../../chickensouple.github.io/posts/" class="navbar-item is-secondary">Posts</a>
          
          
        
        </div>
      </div>
    </div>
  </nav>
<section class="section is-medium">
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title is-2 section-title">Sufficiently Accurate Model Learning</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
        
        <section class="section content has-text-justified">
          <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript" crossorigin="anonymous"></script>
<h1 id="introduction">Introduction</h1>
<p>This work looks at learning dynamics model for planning and control. Planners require a model of the system to work with. This model will inform the planner what happens when you take an action at some specific state. In <a href="../learning_implicit"> previous work </a>, we had applied machine learning to learn heuristics for planning. This work addresses learning the model for planning. A paper containing some results is available <a href="#zhang2021">here</a>.</p>
<h1 id="background">Background</h1>
<p>Planners require a model of the world that will tell us how it will evolve with certain actions. This can be expressed as a differential equation</p>
<p>$$\dot{x} = f(x, u)$$</p>
<p>or as a discrete time function</p>
<p>$$x_{k+1} = f(x_k, u_k)$$</p>
<p>This work will be using discrete time functions, but the ideas are more generally applicable.
Many modern planners will formulate the problem as a nonlinear optimization problem, and solve it with general purpose or more specialized solvers. Examples include <a href="#zucker2013">CHOMP</a>, <a href="#schulman2013">TrajOpt</a>, or <a href="#todorov2005">iLQG</a>. An advantage these planners have over sampling based (such as RRT) or search based (such as A*) planners are that they perform quite admirably in high dimensions and converge quickly to locally optimal solutions. These optimization planners only work in &ldquo;relatively&rdquo; simple environments. Problems where finding the solution might require a search through many homotopy classes are difficult for this class of optimization based planners. They require a decent initialization. But, as it turns out, for many real world situations, planning is more akin to optimizing a general idea of what to do, rather than solving a complicated maze.</p>
<p>One can try to use data to obtain a better model for planning  with these optimization based planners. Usually the constraints on the model are that they have to be differentiable. Using a neural network to represent these models fits this constraint quite well. By using data to tune or learn your model, you can have a more accurate picture of what your system looks like and adapt to any physical changes it undergoes. Maybe the wheel of a car becomes more smooth over time, or a motor in a robot arm becomes less powerful. By using data, the planners can adapt to these changes in a more active way.</p>
<p>There is a vast literature on model learning. In controls, there is a huge trove of &ldquo;System Identification&rdquo; papers which mostly focus on learning linear systems. In robotics, there are many methods that fit Gaussian Process Regression models, or Gaussian Mixture Models, or Neural Networks, or linear models to various systems. This paper presents not a new method, but a new objective for which these methods can use. Most of these methods will simply seek to minimize an error between an observed next state, $$x_{k+1}$$ with that the predicted next state, $$\hat{x}_{k+1}$$. This results in a loss functions that look like</p>
<p>$$ \mathbb{E} || x_{k+1} - f_\theta(x_k, u_k) ||_2^2$$</p>
<p>where $$f_\theta$$ is the learned model.</p>
<h1 id="method">Method</h1>
<p>Our work proposes that we can solve a constrained problem instead of simply minimizing an unconstrained objective. The constraints can contain prior information about the system, and solving the constrained problem can then lead to models better suited for planners.
An simple example is suppose we have a block we are pushing on a table, that has lot of uneven surfaces. Suppose we want to push the block from various points to a common resting location. We can learn a model that is uniformly accurate everywhere. Or, we can learn a model that is selectively good near the goal location. Because far away from the goal, the plan is simple, we push in the direction of the goal. It is only when we are near the goal we care about how much we push so that the block comes to a stop efficiently and correctly. This prior knowledge can be summarized as a constraint on the accuracy near the goal. We can write a constrained problem that looks like</p>
<p>$$ min_\theta \mathbb{E} f(x_k, u_k, x_{k+1})\<br>
s.t. \mathbb{E} g(x_k, u_k, x_{k+1}) \leq 0$$</p>
<p>We have explored solving constrained problems <a href="../../2018/09/09/constrained_wireless"> before </a>. In this case, we expand the theory somewhat. We can no longer analytically compute the expectations in the constrained problem and can only use samples of data. This is because the distribution of trajectories for a system is very complicated. This paper shows that you can still obtain <a href="https://en.wikipedia.org/wiki/Duality_gap">small duality gaps</a> with large enough models and large enough numbers of samples.</p>
<p>Similar to <a href="../../2018/09/09/constrained_wireless"> our previous work </a>, we can use a primal-dual method to solve this. We alternatively minimize the Lagrangian, and maximize the dual variables.</p>
<h1 id="results">Results</h1>
<p>Using some constrained objectives, we can obtain models so that the planner can do better on average. We have tested this in simulation on a state-dependent-friction block pushing task, a ball bouncing task, and a quadrotor landing task. Numerical results show that we can trade off accuracy in unimportant parts of the statespace for better accuracy in others, and obtain better performing planners. The detailed results are under submission right now. But to highlight a few instances for why this is better, we can look at the quadrotor landing. Our constraint is that the model should be more accurate close to the ground. This is where ground effects are most prominant and require greater precision in the model.</p>
<figure display="table">
  <img src="images/quad_traj.png" width="700"/>
  <figcaption display="table-caption" caption-side="bottom"><i>Fig. 1: Quadrotor trajectories.</i></figcaption>
</figure>
<p>A model learned using our objective is better able to compensate for the greater updraft near the ground when landing and can get to the location more accurately.</p>
<h1 id="references">References</h1>
<p><a name="zhang2021" href="https://arxiv.org/pdf/2102.06099.pdf" target="_blank">Zhang, Clark, and Paternain, Santiago, &amp; Ribeiro, Alejandro. Sufficiently Accurate Model Learning for Planning. 2021.</a></p>
<p><a name="zucker2013" href="https://www.ri.cmu.edu/pub_files/2013/5/CHOMP_IJRR.pdf" target="_blank">Zucker, Matt, et al. &ldquo;Chomp: Covariant hamiltonian optimization for motion planning.&rdquo; The International Journal of Robotics Research 32.9-10 (2013): 1164-1193.
</a></p>
<p><a name="schulman2013" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.387.4642&rep=rep1&type=pdf" target="_blank">Schulman, John, et al. &ldquo;Finding Locally Optimal, Collision-Free Trajectories with Sequential Convex Optimization.&rdquo; Robotics: science and systems. Vol. 9. No. 1. 2013.&lt;
/a&gt;</p>
<p><a name="todorov2005" href="http://maeresearch.ucsd.edu/skelton/publications/weiwei_ilqg_CDC43.pdf" target="_blank">Todorov, Emanuel, and Weiwei Li. &ldquo;A generalized iterative LQG method for locally-optimal feedback control of constrained nonlinear stochastic systems.&rdquo; Proceedings of the 2005, American Control Conference, 2005.. IEEE, 2005.
</a></p>

        </section>
      </div>
    </div>
  </div>  
  <div class="container">
    <div class="columns">
      <div class="column has-text-right is-family-monospace is-centered-tablet-portrait">
        Last modified:&nbsp;28 February 2021</div>
    </div>
  </div></section>
<footer class="footer footer-dark">
  <div class="container">
    <div class="columns">
      <div class="column">
        <img src="../../chickensouple.github.io/chickensouple.github.io/footer.svg" alt="">
        
      </div>
      
    <div class="column"> 
        
    
      
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Contacts</h3>
          </div>
          <ul class="link-list">
            
            <li>
              <a href="https://www.linkedin.com/in/clark-zhang-2207a774" target="_blank">
                <span class="icon"><i class="fa fa-linkedin"></i></span>
                
                  LinkedIn
                
              </a>
            </li>
            
            
            <li>
              <a href="https://github.com/chickensouple" target="_blank">
                <span class="icon"><i class="fa fa-github"></i></span>
                
                  Github
                
              </a>
            </li>
                         
            
            <li>
              <a href="mailto:N/A" target="_blank">
                <span class="icon"><i class="fa fa-envelope"></i></span>
                
                  clarkjzhang (at) gmail.com
                
              </a>
            </li>
            
                   
                   
                   
          </ul>
        </div>
      </div>
      

      

    </div>
  </div>
</footer>
    <div id="backtotop"><a href="#"></a></div><div class="sidebar scroll">
  <div class="sidebar-header"><img src="../../chickensouple.github.io/chickensouple.github.io/sidebar.svg" alt="">
    
    <a class="sidebar-close" href="javascript:void(0);">
      <i data-feather="x"></i>
    </a>
  </div>
  <div class="inner">
    <ul class="sidebar-menu">
      <li class="no-children"><a href="chickensouple.github.io/"><div class="columns">
          <table width="100%">  
            <tr>
              <td class="">
                <span class="icon"><i class="fa fa-cubes"></i></span>
                Home
              </td>
              <td class="has-text-right" >
                  
              </td>
            </tr>
          </table>
        </div>
      </a>
      </li>
      <li class="no-children"><a href="chickensouple.github.io/posts/"><div class="columns">
          <table width="100%">  
            <tr>
              <td class="">
                <span class="icon"><i class="fa fa-cubes"></i></span>
                Posts
              </td>
              <td class="has-text-right" >
                  
              </td>
            </tr>
          </table>
        </div>
      </a>
      </li>
    </ul>
  </div>
</div>
<script src="../../chickensouple.github.io/chickensouple.github.io/js/jquery-2.2.4.893e90f6230962e42231635df650f20544ad22affc3ee396df768eaa6bc5a6a2.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI="></script>
  <script src="../../chickensouple.github.io/chickensouple.github.io/js/feather.4.22.0.1ab07abeb9975f283f6b5f29451981be680fbf77ea778f991d457511d210476a.js" integrity="sha256-GrB6vrmXXyg/a18pRRmBvmgPv3fqd4&#43;ZHUV1EdIQR2o="></script>
  <script src="../../chickensouple.github.io/chickensouple.github.io/js/modernizr-3.6.0.e013a1e54e3c19d83537ba42b900d34451e5e4b2e789be27a02ac9b152edb741.js" integrity="sha256-4BOh5U48Gdg1N7pCuQDTRFHl5LLnib4noCrJsVLtt0E="></script>
  <script src="../../chickensouple.github.io/chickensouple.github.io/js/refresh.62c1a9b7d85bcf4d944cd585a01dfa8fb15112a7d2cf9fb819db20493bfe7484.js" integrity="sha256-YsGpt9hbz02UTNWFoB36j7FREqfSz5&#43;4GdsgSTv&#43;dIQ="></script><script>
  window.MathJax = {
    loader: {
      load: ['core', 'input/tex-base', 'output/chtml'],  
      source: {
        'core': '\/chickensouple.github.io\/chickensouple.github.io\/js\/mathjax\/core.d48fedf25c74c54fa6bf79646de92b02155872bdc4f5f7d0bbfc662523d8b4f5.js',
        'input/tex-base': '\/chickensouple.github.io\/chickensouple.github.io\/js\/mathjax\/tex-base.1b68b8741dfc54e8f7222f88bea8ffcfc57ac54b2a2d8f4edf6800aa44d49441.js',
        'output/chtml': '\/chickensouple.github.io\/chickensouple.github.io\/js\/mathjax\/chtml.926cd166e0f8c1f8a566a718d60c9c58a2b7142b156d30d5f02cec7c3b0ad60a.js',
        'output/chtml/fonts/tex': '\/chickensouple.github.io\/chickensouple.github.io\/js\/mathjax\/tex_out.b8b2bb939c0dae84bf1390bfe6d32af13e83f647cdac01d544d2a7a517477e9d.js'
      },
    },
    chtml: {
      fontURL: '/fonts' 
    },
  };
</script><script src="../../chickensouple.github.io/chickensouple.github.io/js/mathjax/startup.234a2513e6bdbc1eee06ca19abceca30fe4034e82afb373c08274c1ba2feb1a6.js" integrity="sha256-I0olE&#43;a9vB7uBsoZq87KMP5ANOgq&#43;zc8CCdMG6L&#43;saY="></script>
  <script src="../../chickensouple.github.io/chickensouple.github.io/js/highlight.9.18.1.b1c58829c55afcc1f568022af4b08ed8976da404d2990b7535bd8e19c0e3310c.js" integrity="sha256-scWIKcVa/MH1aAIq9LCO2JdtpATSmQt1Nb2OGcDjMQw="></script>
  <script src="../../chickensouple.github.io/chickensouple.github.io/js/highlightjs-line-numbers.2.7.0.min.ddfe282e07b7ec1ed069c23f92c7c8216ddb3f1879c4e962d37fd52adbd15a05.js" integrity="sha256-3f4oLge37B7QacI/ksfIIW3bPxh5xOli03/VKtvRWgU="></script><script>
  hljs.initHighlightingOnLoad();
  hljs.initLineNumbersOnLoad();
  document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('.codeinline').forEach((block) => {
      hljs.highlightBlock(block);
    });
  });
</script>

</body>
</html>
